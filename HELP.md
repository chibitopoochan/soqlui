# ヘルプ

## 概要

ブラウザを起動せずにローカルで実行できるSOQLのクライアントツールです。

通常の使い方はチュートリアルを、個別の機能は機能参照を参照してください。
ヒントには活用方法を記載しています。

## チュートリアル

#### 初期設定

アプリケーションを利用するために下記の初期設定が必要です。

- 接続先の登録
- プロキシの設定（任意）

設定方法は次の手順となります。

#####1. アプリケーションの起動

スタートメニューからSOQLを選択します。

#####2. 接続一覧画面を開く

メニューバーからファイル > 接続設定を選択します。

#####3. 接続設定画面を開く

新規ボタンを押下します。

#####4. 接続設定画面で情報を登録

下記の項目を入力し、Saveボタンを押下します。

名称 : 環境名

ユーザ名 : Salesforceのユーザ名

パスワード : Salesforceのパスワード

セキュリティトークン : （任意）セキュリティトークン

環境 : 接続先の環境（本番かSandbox）

APIバージョン : 接続に使用するAPIのバージョン番号


#####5. （任意）プロキシ設定画面を開く

メニューバーからファイル > プロキシ設定を選択します。

#####6. プロキシ設定画面で情報を登録

下記の項目を入力し、保存ボタンを押下します。

有効 : チェックを付けるとプロキシを使った接続を行います。

ホスト : プロキシサーバのURL

ポート : ポート番号

ユーザ名 : プロキシに使用するユーザ名

パスワード : プロキシに使用するパスワード

#### SOQLの実行

アプリケーションの起動からSOQLの実行までの流れは次の通りです。

#####1. アプリケーションの起動

スタートメニューからSOQLを選択します。

#####2. 接続先の選択

Salesforceの接続に使用する接続情報を選択します。

#####3. Salesforceに接続

接続ボタンを押下します。

#####4. SOQLを入力

入力エリアに実行したいSOQLを入力します。

#####5. SOQLを実行

実行ボタンを押下します。

#### SOQLの保存

#####1. SOQLを入力

入力エリアにSOQLを入力します。

#####2. ファイル保存先を開く

メニューバーからファイル > 保存を選択します。

#####3. ファイルを保存

ファイル名と保存先を決め、保存ボタンを押下します。

※拡張子を「環境名.soql」にするとファイルからの直接実行が可能です。


#### データのエクスポート

SOQLの実行結果をファイルにエクスポートする場合の手順は下記のとおりです。

#####1. アプリケーションの起動

スタートメニューからSOQLを選択します。

#####2. 接続先の選択

Salesforceの接続に使用する接続情報を選択します。

#####3. Salesforceに接続

接続ボタンを押下します。

#####4. SOQLを入力

入力エリアに実行したいSOQLを入力します。

#####5. SOQLを実行

エクスポートボタンを押下します。

#####6. 保存先の選択

ファイル名と保存先を決め、保存ボタンを押下します。

※既にファイルが存在する場合、確認のダイアログが表示されます。

#####7. エクスポートの完了

完了するとダイアログが表示されるので、OKボタンを押下します。

#### 定義情報のエクスポート

オブジェクトのメタ情報をエクスポートします。

#####1. アプリケーションの起動

スタートメニューからSOQLを選択します。

#####2. 接続先の選択

Salesforceの接続に使用する接続情報を選択します。

#####3. Salesforceに接続

接続ボタンを押下します。

#####4. オブジェクトの選択

オブジェクト一覧から出力したいオブジェクトをダブルクリックします。

#####5. エクスポートの選択

項目一覧で右クリックし、コンテキストメニューからオブジェクト定義出力を選択します。

#####6. 保存先の選択

保存先を決め、フォルダーの選択をクリックします。

#####7. エクスポートの完了

完了するとダイアログが表示されるので、OKボタンを押下します。

#### 履歴からのSOQL実行

SOQLの実行履歴からSOQLを再実行できます。

#####1. アプリケーションの起動

スタートメニューからSOQLを選択します。

#####2. 接続先の選択

Salesforceの接続に使用する接続情報を選択します。

#####3. Salesforceに接続

接続ボタンを押下します。

#####4. 履歴の選択

実行履歴から右クリックし、コンテキストメニューからSOQLを反映を選択します。

#####5. SOQLを実行

実行ボタンを押下します。

#### お気に入りの登録

履歴からお気に入りにSOQLを登録し、名前を設定します。

#####1. アプリケーションの起動

スタートメニューからSOQLを選択します。

#####2. 接続先の選択

Salesforceの接続に使用する接続情報を選択します。

#####3. Salesforceに接続

接続ボタンを押下します。

#####4. 履歴の選択

実行履歴から右クリックし、コンテキストメニューからお気に入りに追加を選択します。

#####5. お気に入りの選択

お気に入り一覧から右クリックし、コンテキストメニューから名称変更を選択します。

#####6. お気に入りの名前設定

新しいお気に入りの名前を入力し、OKボタンを押下します。

## 機能参照

#### メニューバー

##### 接続情報の設定

Salesforceの接続に使用する設定を行います。

名称 : 接続先の名前

ユーザ名 : Salesforceのユーザ名

パスワード : Salesforceのパスワード

セキュリティトークン : （任意）セキュリティトークン

環境 : 接続先の環境（本番かSandbox）

APIバージョン : 接続に使用するAPIのバージョン番号

##### プロキシの設定

プロキシを設定します。

有効 : チェックを付けるとプロキシを使った接続を行います。

ホスト : プロキシサーバのURL

ポート : ポート番号

ユーザ名 : プロキシに使用するユーザ名

パスワード : プロキシに使用するパスワード


##### SOQLの保存

SOQLの入力エリアをファイルに保存します。

##### アプリケーションの設定

アプリケーションの設定を開きます。
設定はアプリケーションを再起動後に反映されます。

**全般**

標準Windowを使用 : アプリケーションのWindow枠を標準にします。

アプリにCSSを適用 : 画面のスタイルシートを有効にします。

エディタ（ACE）によるハイライトの使用 : SOQLの入力エリアにACEを使用します。
使用すると一部のテキストがハイライトされます。

アプリ独自にSOQLを拡張 : SOQLを拡張します。詳細は「SOQLの拡張」を参照してください。

デバッグログの出力 : ログをデバッグモードに切り替えます。

**フォーマット**

フォーマットで使用できる項目一覧です。修正はできません。

**接続**

SOAP URL : SOAP接続に使用するURL。
%sが先頭から順に、環境、APIバージョン番号に置き換わります。

ログインURL : ブラウザで開く際に使用するURL。
%sが先頭から順に、環境、ユーザ名、パスワード、ログイン後のURLに置き換わります。

オブジェクト一覧 : オブジェクトをブラウザで開く際に使用するURL。
%sが先頭から順に、Key Prefixに置き換わります。

レコードURL : レコードをブラウザで開く際に使用するURL。
%sが先頭から順に、レコードIDに置き換わります。

代理ログイン : 代理ログインに使用するURL。
%sが先頭から順に、組織ID、ユーザのID、ログアウト後のURL、遷移先のURLに置き換わります。

代理ログイン（遷移先）: 代理ログインの遷移先URL。

代理ログイン（戻り先）: 代理ログインのログアウト後のURL。

ローカライズ：接続に使用する言語。

REST API : Base64を使用しない場合に使用するREST APIのURL
%sが先頭から順に、インスタンスURL、オブジェクト名、ID、項目名に置き換わります。

**SOQL**

タブ数 : SOQLの入力エリアで使用できるタブの数

履歴数 : 履歴として保持する最大件数

最大件数 : レコードの最大件数初期値

##### アプリケーションの終了

アプリケーションを終了します。

#### 接続

##### 接続情報の選択

「接続情報の設定」で登録した設定が選択できます。
接続したい設定を選択します。

##### 接続ボタン

選択された接続情報でSalesforceに接続を行います。
成功するとオブジェクト一覧にオブジェクトが表示されます。

※失敗時にはエラーのダイアログが表示されます

接続中は他の接続先に変更することができません。
変更したい場合は「切断ボタン」を使用します。

##### Tooling

チェックを付けるとTooling APIで接続します。

※切り替える場合、再接続が必要です

##### 再接続ボタン

タイムアウト等、再度接続する必要がある場合は押下します。

※接続失敗時にはエラーのダイアログが表示されます

##### 切断ボタン

Salesforceとの接続を切断します。
他の接続情報を選択できるようになります。

#### オブジェクト一覧

##### 一覧表示

「接続ボタン」で接続するとオブジェクトの一覧が表示されます。

##### 検索ボックス

検索ボックスにキーワードを入れると、名前にキーワードを含む
オブジェクトのみが一覧に表示されます。

検索ボックスを空にすると、全てのオブジェクトが表示されます。

##### コンテキストメニュー

オブジェクト一覧上で右クリックするとコンテキストメニューが開きます。
メニューから下記の操作が可能です。

項目定義の表示 : 項目一覧を表示します。

SOQL作成（件数） : 行数を返すSOQLを自動生成します。

SOQL作成（全項目） : 全項目を取得するSOQLを自動生成します。

選択領域のコピー : 選択範囲をExcel形式でコピーします。

選択領域のコピー（Excel形式ヘッダ無し） : 選択範囲をヘッダを含まないExcel形式でコピーします。

ブラウザで表示 : 対象オブジェクトをブラウザで開きます。

#### 項目一覧

##### 一覧表示

オブジェクト一覧からオブジェクトをダブルクリックすると
項目の一覧が表示されます。

##### 検索ボックス

検索ボックスにキーワードを入れると、名前にキーワードを含む
項目のみが一覧に表示されます。

検索ボックスを空にすると、全ての項目が表示されます。

##### コンテキストメニュー

項目一覧上で右クリックするとコンテキストメニューが開きます。
メニューから下記の操作が可能です。

SOQL作成（選択範囲） : 選択範囲の項目でSOQLを自動生成します。

選択領域のコピー : 選択範囲をコピーします。

選択領域のコピー(CSV用) : 選択範囲をCSV形式でコピーします。

選択領域のコピー(Excel用) : 選択範囲をExcel形式(ヘッダ有)でコピーします。

選択領域のコピー(Excel用ヘッダ無し) : 選択範囲をExcel形式(ヘッダ無)でコピーします。

オブジェクト定義出力 : オブジェクトのメタ情報を出力します。

#### クエリ

##### タブ

SOQLの入力エリアをタブで切り替えられます。

##### 入力エリア

SOQLを入力するエリアです。
エディタを有効にすると文字がハイライトされます。

##### コンテキストメニュー

入力エリア上で右クリックするとコンテキストメニューが開きます。
メニューからコピー、切り取り、貼り付けが行えます。

##### 最大件数

SOQL実行時の最大件数を指定します。

※最大1000行までで、1000行以上指定しても1000行になります。

##### 削除含む

チェックを付けるとSOQLの検索対象に削除済みも含めます。

##### 結合

チェックを付けるとサブクエリが1列1行で出力されます。

※チェックを付けない場合、サブクエリの列と行が展開されます

※複数のサブクエリには動作確認していません

##### 実行ボタン

SOQLを実行します。取得できない項目やレコードが0行の場合、エラーメッセージが表示されます。

##### エクスポートボタン

SOQLを実行し、CSVファイルに出力します。

※既にファイルが存在する場合、確認のダイアログが表示されます

※Attachement,ContentVersion,Documentの場合、必要項目があればファイルもエクスポートします

##### キャンセルボタン

SOQLが実行中の場合、実行をキャンセルできます。

##### ショートカットキー

入力エリアでショートカットキーが実行できます。

「Ctrl + Enter」：SOQLの実行

「Ctrl + I」：ズームイン

「Ctrl + O」：ズームアウト

「Ctrl + P」:スクリーンショット

#### 実行結果

##### タブ

SOQLを実行すると、タブが追加されます。
タブを選択すると実行結果が切り替わります。

右クリックからタブを閉じることができます。

##### 一覧表示

SOQLを実行すると、実行結果が一覧で表示されます。

##### 検索ボックス

検索ボックスにキーワードを入れると、名前にキーワードを含む
レコードのみが一覧に表示されます。

検索ボックスを空にすると、全てのレコードが表示されます。

##### コンテキストメニュー

実行結果の一覧上で右クリックするとコンテキストメニューが開きます。
メニューから下記の操作が可能です。

SOQL作成（条件指定） : 選択範囲を条件にした、全項目を取得するSOQLを自動生成します。

選択領域のコピー : 選択範囲をコピーします。

選択領域のコピー(CSV用) : 選択範囲をCSV形式でコピーします。

選択領域のコピー(Excel用) : 選択範囲をExcel形式(ヘッダ有)でコピーします。

選択領域のコピー(Excel用ヘッダ無し) : 選択範囲をExcel形式(ヘッダ無)でコピーします。

ブラウザで表示 : レコードをブラウザで表示します。
※IDが含まれていないと表示されません。

代理ログイン : ユーザIDから、そのユーザに代理ログインします。
※ユーザIDが選択されていないとログインに失敗します。

#### お気に入り

##### 一覧表示

お気に入りに登録したSOQLが一覧で表示されます。

##### 検索ボックス

検索ボックスにキーワードを入れると、名前にキーワードを含む
お気に入りのみが一覧に表示されます。

検索ボックスを空にすると、全てのお気に入りが表示されます。

##### コンテキストメニュー

項目一覧上で右クリックするとコンテキストメニューが開きます。
メニューから下記の操作が可能です。

SOQLを反映 : SOQLの入力エリアにSOQLをコピーします。
名称変更 : お気に入りの名前を変更します。
削除 : お気に入りから削除します。

#### 履歴

##### 一覧表示

SOQLの実行履歴が一覧として表示されます。

##### 検索ボックス

検索ボックスにキーワードを入れると、SOQLと日付にキーワードを含む
履歴のみが一覧に表示されます。

検索ボックスを空にすると、全ての履歴が表示されます。

##### コンテキストメニュー

項目一覧上で右クリックするとコンテキストメニューが開きます。
メニューから下記の操作が可能です。

SOQLを反映 : SOQLの入力エリアにSOQLをコピーします。
コピー : SOQLをコピーします。
追加 : 選択された履歴を削除します。
お気に入りに追加 : お気に入りに追加します。

## ヒント

##### 画面の移動とサイズ

独自のWindow枠の場合、
タイトル（SOQLUI）の部分をドラッグすることでWindowを移動できます。
最大化、最小化以外のサイズ変更はできません。

##### フォーマットの修正

インストール先にある「config」フォルダの「format.xml」ファイルに
メタ情報をエクスポート時に使用するフォーマットがあります。

##### SOQLの拡張

SOQLの拡張が有効な場合、以下の記述が可能です。

IDのみの記載 : オブジェクトを判定し、全項目を取得します。

バインド変数 : 「:変数名」で実行時に値を置き換えます。
履歴にはバインド変数の状態で記録されます。

###### ログ出力

ログはデバッグモードで詳細が出力されます。
5MBの3世代まで保持します。

